import random
import re

class MurinskyTranslator:
    def __init__(self):
        # СЛОВАРЬ
        self.dictionary = {
            "друг": ["друн", "дуность"],
            "дед": ["дод", "дедность", "додх"],
            "дедушка": ["дод", "дедность"],
            "я": ["ч"],
            "ты": ["тк"],
            "папа": ["батч"],
            "жена": ["жинка", "жиночка"],
            "сын": ["сыр", "сырок", "сырность"],
            "пиво": ["пивность", "пивкоф"],
            "кот": ["котость", "кот-бурмалдот"],
            "белка": ["белочка-бурмалделочка"],
            "тигрята": ["тгрята-бурмалдята"],
            "мойдодыр": ["мойдодырность", "мойдодыр"],
            "кто это": ["кьтйо этость", "ктотность"],
            "когда": ["кобда", "когда-нить"],
            "вкусняшка": ["вкустность"],
            "плодится": ["плодитчя"],
            "стрим": ["стримность", "эфирность"],
            "админ": ["одмен", "админность"],
            "привет": ["прiвiт", "привет", "привет артур"],
            "паук": ["паучок-бурмалдок", "паун", "павун", "павук"],
            "трудовик": ["трудовун"],
            "физрук": ["физрун"],
            "суп": ["супность чечевичность", "чечевичный суп"],
            "дом": ["домность", "доминка", "дом-бурмалдом"],
            "город": ["горун", "городность", "горобурд", "мурино", "молочное", "остров эпштейна"],
            "мытищи": ["мынищи", "мытищи"],
            "мурино": ["муринскость", "муриньё", "муробурино", "муриность"],
            "школа": ["школунья", "школость", "школобурдость"],
            "учитель": ["училун", "училость", "учил-бурмалдил"],
            "работа": ["работость"],
            "деньги": ["денюжность"],
            "хомяк": ["хомяк-бурмалдяк"],
            "машина": ["машинность"],
            "автобус": ["автобусность"],
            "поезд": ["поездун", "поездность"],
            "поездка": ["поездунка", "поездочность"],
            "улица": ["улицунья", "улицность"],
            "магазин": ["магазун", "магазинность"],
            "еда": ["едовость", "едо"],
            "хлеб": ["хлебность"],
            "мясо": ["мясность", "мяс"],
            "картошка": ["картофельность"],
            "курица": ["куробурка", "куринность"],
            "вода": ["водность"],
            "чай": ["чаёк-бурмалдёк", "чайность"],
            "кофе": ["кофейность", "кофн"],
            "сахар": ["сахарность", "сахрун"],
            "соль": ["сольность"],
            "ночь": ["ночность"],
            "день": ["денность", "ден"],
            "утро": ["утренность"],
            "вечер": ["вечерность"],
            "сон": ["сонность"],
            "страх": ["страшность"],
            "зло": ["злобунство", "злобность"],
            "omg": ["омайгад", "омайгадность"]
            "добро": ["добрость"],
            "любовь": ["любовность", "лубувь", "любность"],
            "ненависть": ["ненавистность", "ненавидунство"],
            "игра": ["игрость", "игрульктность"],
            "игрок": ["игрокость"],
            "сервер": ["серверность"],
            "баг": ["багость"],
            "глитч": ["глитчевность"],
            "читер": ["читерун", "читерность"],
            "удар": ["ударность"],
            "разрез": ["разрезность"],
            "меч": ["мечность"],
            "кровь": ["кровность"],
            "монстр": ["монстрость", "монструн"],
            "человек": ["человун", "человечность"],
            "смерть": ["смертность"],
            "жизнь": ["жизненность"],
            "смех": ["смехность"],
            "крик": ["крикость"],
            "гром": ["громобурдость"],
            "огонь": ["огненность"],
            "дым": ["дымность"],
            "туман": ["туманность"],
            "ветер": ["ветерун", "ветренность"],
            "грязь": ["грязность"],
            "мусор": ["мусорность"]
        }

        # Карта опечаток
        self.typo_map = {
            'к': 'л', 'о': 'п', 'а': 'п', 'и': 'ы', 'е': 'н', 'д': 'л', 
            'б': 'д', 'р': 'н', 'т': 'ь', 'с': 'ы', 'м': 'н'
        }

    def _apply_un_rule(self, word):
        """Правило окончания 'ун' для ролей и профессий"""
        # Если слово длинное и заканчивается на типичные суффиксы лиц
        suffixes = ('ик', 'ек', 'ер', 'тель', 'ок')
        for s in suffixes:
            if word.endswith(s) and len(word) > 4:
                return word[:-len(s)] + "ун"
        return word

    def _apply_typo(self, word):
        """Гарантированная опечатка (шанс 50%)"""
        if len(word) > 3 and random.random() > 0.5:
            word_list = list(word)
            idx = random.randint(0, len(word_list) - 1)
            char = word_list[idx].lower()
            if char in self.typo_map:
                word_list[idx] = self.typo_map[char]
            return "".join(word_list)
        return word

    def translate_word(self, word):
        w_low = word.lower()
        is_upper = word[0].isupper()

        # 1. Сначала ищем в словаре
        if w_low in self.dictionary:
            res = random.choice(self.dictionary[w_low])
            return res.capitalize() if is_upper else res

        # 2. Если слова нет в словаре, применяем правила каверканья
        
        # Правило -ун
        new_word = self._apply_un_rule(w_low)
        
        # Если правило -ун не сработало, пробуем -ость (шанс 40%)
        if new_word == w_low and len(w_low) > 4 and random.random() > 0.6:
            new_word = w_low[:-1] + "ость"
        
        # Логика -тся -> -тчя
        if new_word.endswith(("тся", "ться")):
            new_word = new_word.replace("тся", "тчя").replace("ться", "тчя")

        # Применяем опечатку к результату
        new_word = self._apply_typo(new_word)

        return new_word.capitalize() if is_upper else new_word

    def process_text(self, text):
        # Разбиваем текст, сохраняя пробелы и знаки
        tokens = re.findall(r"\w+|[^\w\s]|\s+", text)
        result = []
        for t in tokens:
            if t.isalpha():
                result.append(self.translate_word(t))
            else:
                result.append(t)
        return "".join(result)

# Тест
while True:
    translator = MurinskyTranslator()
    test_text = input("Введите текст для перевода (или 'выход' для завершения): ")
    if test_text.lower() == "выход":
        break

    print(translator.process_text(test_text))
